use ark_ec::{
    models::CurveConfig,
    short_weierstrass::{Affine, Projective, SWCurveConfig},
};
use ark_ff::{Field, MontFp};

use crate::{Fq, Fq3, Fr};

pub type G2Affine = Affine<Parameters>;
pub type G2Projective = Projective<Parameters>;

#[derive(Clone, Default, PartialEq, Eq)]
pub struct Parameters;

impl CurveConfig for Parameters {
    type BaseField = Fq3;
    type ScalarField = Fr;

    /// COFACTOR =
    /// 467006868871301157189180448474110253957439016910762869048313089659521018519305333367008505
    /// 648861383406423939804726343769906643274217267196593058150921489487572447702739920018968614
    /// 279855418945021881201827627443296324173276434309526070292471022126418140907528816632001019
    /// 621582810861647541172738128077129202864961051235430738799831580936832419853670413662115853
    /// 69085142944917218669963168390913312649816
    #[rustfmt::skip]
    const COFACTOR: &'static [u64] = &[
        0x3d8bb13852b37258,
        0x08a744704b60756a,
        0x40990f03f6bbb44c,
        0x5860296c8655a2d0,
        0xca0ab022dd85d277,
        0xe5cff8d8da97d412,
        0xc922f7254ff1de3a,
        0x889851fad89c3d6b,
        0x65f9d6b911d170af,
        0x30f1bbb75e2a8965,
        0xcf4e51e558bd983b,
        0x383ac1d8ace7061a,
        0xd38fd452b212361d,
        0x2239a455d6a0d79b,
        0xb49d0ca2ea2d3435,
        0xc1971c19e767e733,
        0xc8871c0c5737469f,
        0x68eda4913c09c94e,
        0x2f9fc92f03f0752b,
        0x744aad234aa648e8,
        0x7f876d9a28cad
    ];

    /// COFACTOR^(-1) mod r =
    /// 17080265565826810148442905712742608617893955886405764739294593406807085699010
    const COFACTOR_INV: Fr =
        MontFp!("17080265565826810148442905712742608617893955886405764739294593406807085699010");
}

impl SWCurveConfig for Parameters {
    /// TWIST = (0, 1, 0)
    /// COEFF_A = G1::COEFF_A * TWIST^2
    const COEFF_A: Fq3 = Fq3::new(Fq::ZERO, Fq::ZERO, MontFp!("11"));

    /// TWIST = (0, 1, 0)
    /// COEFF_B = G1::COEFF_B * TWIST^3 = G1::COEFF_B * NONRESIDE
    const COEFF_B: Fq3 = Fq3::new(
        MontFp!("60313575868966829693953761960246825440666484139148490842577744993785104533381370224178433525672385154308079179575052372851161376922649714922222873453290823245"),
        Fq::ZERO,
        Fq::ZERO
    );

    /// AFFINE_GENERATOR_COEFFS = (G2_GENERATOR_X, G2_GENERATOR_Y)
    const GENERATOR: G2Affine = G2Affine::new_unchecked(G2_GENERATOR_X, G2_GENERATOR_Y);
    // This is the point (u + 6, 10712275838951368821424541639605060477105198900195785619305001418
    // 0527369029590285333199570051830235195479646868535948945524004639905582097490381889182204747
    // 4316*u^2 + 12487045338730539411998988249803746244696970941874566108867288350522186288304247
    // 23327309047283055326822930546864485763838819782733866620493676113627089173370982*u + 126175
    // 5587193373427872944913215473535946613458087200264579795064325585710324884931567237591548270
    // 682697182704700415521137976934693362203926429252263848343131996)
    // multiplied by the cofactor

    // The number of points on the curve
    // 270378505173926632481321335518237349740903897520016195491209310803193572427659534245551293
    // 198007693545985368000243542855719700778274454306456848952121808702031765652605454718786848
    // 960886502692473118097901022342918967970973668598438997582774558212385162967572696926989723
    // 396409655877297469096663495044917660593833948255019108484666904264362849088324959881345902
    // 828073292722739337925114623853914236640420981604257250552291280989513460174593023489486448
    // 8010244201183986386127979384
}

const G2_GENERATOR_X: Fq3 = Fq3::new(G2_GENERATOR_X_C0, G2_GENERATOR_X_C1, G2_GENERATOR_X_C2);
const G2_GENERATOR_Y: Fq3 = Fq3::new(G2_GENERATOR_Y_C0, G2_GENERATOR_Y_C1, G2_GENERATOR_Y_C2);

/// G2_GENERATOR_X_C0 =
/// 1058813210570340824004153189320081270420653755556213954639445078102500613753286733692109606381198120908493779023113385723992796058382610331153971158879166551863
pub const G2_GENERATOR_X_C0: Fq = MontFp!("1058813210570340824004153189320081270420653755556213954639445078102500613753286733692109606381198120908493779023113385723992796058382610331153971158879166551863");

/// G2_GENERATOR_X_C1 =
/// 196865002849905787805765445879341507027187688575506646512628516931121780666468640926648563392056107003626460456622941189329260558588081785484508217238390497292
pub const G2_GENERATOR_X_C1: Fq = MontFp!("196865002849905787805765445879341507027187688575506646512628516931121780666468640926648563392056107003626460456622941189329260558588081785484508217238390497292");

/// G2_GENERATOR_X_C2 =
/// 1377265563492786224194804411603617173217540790909719253509306541917992768502670064195702044471260408494381354707748848738125248348649646634910956913682193136280
pub const G2_GENERATOR_X_C2: Fq = MontFp!("1377265563492786224194804411603617173217540790909719253509306541917992768502670064195702044471260408494381354707748848738125248348649646634910956913682193136280");

/// G2_GENERATOR_Y_C0 =
/// 442779922527637159752575668290042099817747512361888919676148603634249167363049616820640302340435531515172071183497643033965414948301929708139132834351852315196
pub const G2_GENERATOR_Y_C0: Fq = MontFp!("442779922527637159752575668290042099817747512361888919676148603634249167363049616820640302340435531515172071183497643033965414948301929708139132834351852315196");

/// G2_GENERATOR_Y_C1 =
/// 918372273795560193053798966794846302410007288302868319825165784074846517467370837628695374345855344100944301946623545656978063898633908061105750019975407818679
pub const G2_GENERATOR_Y_C1: Fq = MontFp!("918372273795560193053798966794846302410007288302868319825165784074846517467370837628695374345855344100944301946623545656978063898633908061105750019975407818679");

/// G2_GENERATOR_Y_C2 =
/// 775505375529778547738339393807852734185096966933415837160978091636770668168854479910953755888557009293465863668119239245529978653041760070415344010193676619728
pub const G2_GENERATOR_Y_C2: Fq = MontFp!("775505375529778547738339393807852734185096966933415837160978091636770668168854479910953755888557009293465863668119239245529978653041760070415344010193676619728");
