use ark_ec::{
    models::CurveConfig,
    short_weierstrass::{Affine, Projective, SWCurveConfig},
};
use ark_ff::{Field, MontFp};

use crate::yafa_108::{Fq, Fq3, Fr};

pub type G2Affine = Affine<Parameters>;
pub type G2Projective = Projective<Parameters>;

#[derive(Clone, Default, PartialEq, Eq)]
pub struct Parameters;

impl CurveConfig for Parameters {
    type BaseField = Fq3;
    type ScalarField = Fr;

    /// COFACTOR =
    /// 726727083749875243601367297650446539636475653158658548094386199997254041505338892542077072
    /// 604090407313221302528493113026570723121477446163253454571868628445936148516109626162649376
    /// 254253642015731202974495561864542223425201601179967356463103621158406594611471057687440343
    /// 609487221695717987865639032712406176075737407002333508025998351040232415566294120094328738
    /// 730130004320644649303690084017711366401782034325257041620322684412975931127936412
    #[rustfmt::skip]
    const COFACTOR: &'static [u64] = &[
        0x0a3f6e90741ab59c,
        0xe49b352321658334,
        0xc47f7532f5ab8ba7,
        0x0e8756bf5d4b6cb8,
        0x697ec02d44c51069,
        0x3bed4b59d216eb73,
        0x755d79c7f7c8fe15,
        0xb07e3224a62e1e8c,
        0x8f0a3da89456a015,
        0x3f882937be678237,
        0xce56533f6f99e3f2,
        0x3c148e44b14663f5,
        0x451d2c11a023d1af,
        0xaec8b335832ead0f,
        0x6864872609325f6a,
        0x71238d022753348f,
        0x0cb68579011121a5,
        0xdaf708232f6bef5c,
        0x0a5d35e32a1a8a02,
        0x682d9d3698335dbd,
        0xc9411433bec1eaf0,
        0xccdd742076ed59cd,
        0x16c8006f424b454
    ];

    /// COFACTOR^(-1) mod r =
    /// 24748072770251319791973325578500664370772743298719163423040175464668727375471
    const COFACTOR_INV: Fr =
        MontFp!("24748072770251319791973325578500664370772743298719163423040175464668727375471");
}

impl SWCurveConfig for Parameters {
    /// TWIST = (0, 1, 0)
    /// COEFF_A = G1::COEFF_A * TWIST^2
    const COEFF_A: Fq3 = Fq3::new(Fq::ZERO, Fq::ZERO, MontFp!("1"));

    /// TWIST = (0, 1, 0)
    /// COEFF_B = G1::COEFF_B * TWIST^3 = G1::COEFF_B * NONRESIDE
    const COEFF_B: Fq3 = Fq3::new(
        MontFp!("14869344209424698109839845806342905080331479851242691994041738749858526070153474992368435483308225867047574780918175510715287530535246359788046049073076831128055132155415569"),
        Fq::ZERO,
        Fq::ZERO
    );

    /// AFFINE_GENERATOR_COEFFS = (G2_GENERATOR_X, G2_GENERATOR_Y)
    const GENERATOR: G2Affine = G2Affine::new_unchecked(G2_GENERATOR_X, G2_GENERATOR_Y);
    // This is the point (u + 2, 32014734316364727540956010845561405233149753232274459975113699583
    // 3793748423016003125970690849203611765945332632577291407220679588837261255927224665966821381
    // 41631754191294521*u^2 + 1597192353005249024898425938494798758863021096991491789227839880998
    // 6012832643384011132836166898725714529205721095492516009157922058036636373894012969203106898
    // 963518207119456*u + 10633176953043777298407003600731114552925024176440400489846685256003529
    // 6144991375119397053938193217175419915280950944364555506195150761226841106908660018151425444
    // 51318796653)
    // multiplied by the cofactor
    //
    // The number of points on the curve
    // 4207462366637005728638671694191523449030292895614309630877616053643032451949909726550150806
    // 2714703535105371963205517603709435262196010484868233287605253150327027775690712458980440490
    // 3979060500844302758350575520085813298366855865197676201422696217524867195886826205014467608
    // 5320418747340529845497346138045795418525542163466803305143448525019369901677575679379661219
    // 6104264506063016615953545688552023300539485091488749290712693247935919429385644454727095122
    // 548621526286178263740745587979387211273325276778354428701082988
}

const G2_GENERATOR_X: Fq3 = Fq3::new(G2_GENERATOR_X_C0, G2_GENERATOR_X_C1, G2_GENERATOR_X_C2);
const G2_GENERATOR_Y: Fq3 = Fq3::new(G2_GENERATOR_Y_C0, G2_GENERATOR_Y_C1, G2_GENERATOR_Y_C2);

/// G2_GENERATOR_X_C0 =
/// 2144075606043480807828365590492694234210368790052396957614938792829948525848515398640939009389487447499051578967694655194244204498763640795577979212623136468433102529338418
pub const G2_GENERATOR_X_C0: Fq = MontFp!("2144075606043480807828365590492694234210368790052396957614938792829948525848515398640939009389487447499051578967694655194244204498763640795577979212623136468433102529338418");

/// G2_GENERATOR_X_C1 =
/// 5688052256669949965351156528149641023902919771788384644882243604428698741027397184154951589111036521582512484671792223177650785218478132058344518120662037347922960840572619
pub const G2_GENERATOR_X_C1: Fq = MontFp!("5688052256669949965351156528149641023902919771788384644882243604428698741027397184154951589111036521582512484671792223177650785218478132058344518120662037347922960840572619");

/// G2_GENERATOR_X_C2 =
/// 8718744646094917079121598663285446302463293945024002822122984813533110934175194844861715093147184310037361617199011275714568048971798902727563006340403366068343007633698354
pub const G2_GENERATOR_X_C2: Fq = MontFp!("8718744646094917079121598663285446302463293945024002822122984813533110934175194844861715093147184310037361617199011275714568048971798902727563006340403366068343007633698354");

/// G2_GENERATOR_Y_C0 =
/// 6721393125519952302643223337392747275570840472077267337164350813956308851368708045179236439287237062232496019803209972892557460562754752269842257458059308788436772306254505
pub const G2_GENERATOR_Y_C0: Fq = MontFp!("6721393125519952302643223337392747275570840472077267337164350813956308851368708045179236439287237062232496019803209972892557460562754752269842257458059308788436772306254505");

/// G2_GENERATOR_Y_C1 =
/// 24984743791347230476325173738363284018417875284673702027452729139548264598285761695421062225159938388233674305822308753331168943635552115197426103878317909016655323529335590
pub const G2_GENERATOR_Y_C1: Fq = MontFp!("24984743791347230476325173738363284018417875284673702027452729139548264598285761695421062225159938388233674305822308753331168943635552115197426103878317909016655323529335590");

/// G2_GENERATOR_Y_C2 =
/// 12255115989171307047293326319949269193572734871511594640493611189404037375089893190982383138283659747055114306657283690196141763496185773509684015925943823580267438325371819
pub const G2_GENERATOR_Y_C2: Fq = MontFp!("12255115989171307047293326319949269193572734871511594640493611189404037375089893190982383138283659747055114306657283690196141763496185773509684015925943823580267438325371819");
